[build]
builder = "railpack"
buildCommand = "npm install && cd frontend && npm run build && cd ../backend && npm install && npx prisma generate && npm run build"

[deploy]
startCommand = "cd backend && echo 'Starting deployment...' && npx prisma db push && echo 'Database schema pushed' && echo 'Starting server...' && node dist/server.js"

[[services]]
name = "backend"

[services.variables]
NODE_ENV = "production"
PORT = "${{ PORT }}"